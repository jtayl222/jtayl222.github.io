<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Jeffrey Taylor - Building Production A/B Testing Infrastr...</title>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" media="print" onload="this.media='all'">
<noscript>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
</noscript>



<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="manifest" href="/assets/manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#f0f0f0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Jeffrey Taylor's App">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="msapplication-TileColor" content="#2d89ef">
  <meta name="msapplication-starturl" content="/">
  <meta name="application-name" content="Jeffrey Taylor's App">
  <meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">


  <meta name="description" content="Part 2: Building Production A/B Testing Infrastructure for Fraud Detection Models Technical Implementation with Seldon Core v2 Pattern 3 Keywords: ...">
  <meta name="robots" content="index, follow">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Building Production A/B Testing Infrastructure for Fraud Detection ...">

<meta name="twitter:description" content="Part 2: Building Production A/B Testing Infrastructure for Fraud Detection Models Technical Implementation with Seldon Core v2 Pattern 3 Keywords: Seldon Core v2, Fraud Detection MLOps, Kubernetes ...">
<meta name="twitter:image" content="http://0.0.0.0:4000/assets/img/home/home-heading.jpg">
<meta property="og:site_name" content="Jeffrey Taylor">
<meta property="og:type" content="website">
<meta property="og:title" content="Building Production A/B Testing Infrastructure ...">
<meta property="og:description" content="Part 2: Building Production A/B Testing Infrastructure for Fraud Detection Models Technical Implementation with Seldon Core v2 Pattern 3 Keywords: ...">
<meta property="og:url" content="http://0.0.0.0:4000/fraud-ab-testing-part-2.html">
<meta property="og:image" content="http://0.0.0.0:4000/assets/img/home/home-heading.jpg">
  <script type="application/ld+json">{
  "@context": "https://schema.org"
  ,"@graph": [
    {
      "@type": "Person"
      ,"@id": "http://0.0.0.0:4000/#person"
      ,"name": "Jeffrey Taylor"
      ,"url": "http://0.0.0.0:4000/tabs/about.html"
      ,"image": "http://0.0.0.0:4000/assets/img/about/about.jpg"
      ,"description": "Jeffrey Taylor - MLOps Engineer specializing in production-ready machine learning infrastructure, Kubernetes orchestration, and automated ML workfl..."
  },{
    "@type": "WebSite"
    ,"@id": "http://0.0.0.0:4000/#website"
    ,"url": "http://0.0.0.0:4000/"
    ,"name": "Jeffrey Taylor"
    ,"description": "Jeffrey Taylor - MLOps Engineer specializing in production-ready machine learning infrastructure, Kubernetes orchestration, and automated ML workfl..."
    ,"publisher": {"@id": "http://0.0.0.0:4000/#person"}
    ,"inLanguage": "en-US"
    ,"sameAs": ["https://github.com/jtayl222","https://www.linkedin.com/in/jefftaylor22"]
    ,"copyrightHolder" : {"@id": "http://0.0.0.0:4000/#person"}
    ,"copyrightYear" : ""
  },{
    "@type": "WebPage"
    ,"@id": "http://0.0.0.0:4000/fraud-ab-testing-part-2.html#webpage"
    ,"url": "http://0.0.0.0:4000/fraud-ab-testing-part-2.html"
    ,"name": "Building Production A/B Testing Infrastructure for Fraud Detection Models"
    ,"isPartOf": {"@id": "http://0.0.0.0:4000/#website"}
    ,"breadcrumb": {"@id": "http://0.0.0.0:4000/fraud-ab-testing-part-2.html#breadcrumb"}
    ,"primaryImageOfPage": "http://0.0.0.0:4000/assets/img/home/home-heading.jpg"
    ,"description": "Part 2: Building Production A/B Testing Infrastructure for Fraud Detection Models Technical Implementation with Seldon Core v2 Pattern 3 Keywords: ..."
    ,"inLanguage": "en-US"
    ,"potentialAction": {
      "@type": "ReadAction"
      ,"target": "http://0.0.0.0:4000/fraud-ab-testing-part-2.html"
    }
  },{
      "@type": "BreadcrumbList",
      "@id": "http://0.0.0.0:4000/fraud-ab-testing-part-2.html#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem"
          ,"position": 1
          ,"name": "Home"
          ,"item": "http://0.0.0.0:4000/"
        },
        {
          "@type": "ListItem"
          ,"position": 2
          ,"name": "Building Production A/B Testing Infrastructure for Fraud Detection Models"
        }
      ]
    }
  ]
}</script>


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<link href="/assets/css/main.css" rel="stylesheet"><link href="/assets/css/nav-media.css" rel="stylesheet">

  </head>

  <body >
    <script src="/assets/js/color-scheme-attr-init.js" data-mode="false"></script>
    <nav class="navbar navbar-default top-nav">
  <div class="navbar-header">
    <button type="button" aria-label="Side menu" class="navbar-toggle collapsed pull-left top-nav-menu-toggle" data-toggle="collapse" data-target="#id_top-nav-menu-toggle" aria-expanded="false">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand top-nav-brand" href="/" translate="no">Jeffrey Taylor</a>
    </div>
  <div class="color_scheme_switch_top_holder" data-toggle="tooltip" data-placement="bottom" title="Color scheme">
  <label class="color-scheme-switch hover-effect">
    <input type="checkbox" class="checkbox_color_switch" />
    <span></span>
  </label>
</div>

  
</nav>
<nav id="side-nav-container">
  <div class="side-nav">
    <div class="side-nav-brand">
      <img src="/assets/img/default/profile_pic.jpg" alt="">
      <div class="brand-holder">
        <a href="/" translate="no">Jeffrey Taylor</a>
        </div>
      <p>&nbsp;MLOps Engineer</p>
      <br>
        
    </div>
    <br>
    <a href="javascript:void(0);" class="side-nav-close" role="button" rel="nofollow">
        <i class="fa fa-angle-double-left fa-2x" aria-hidden="true"></i>
      </a>
    <hr>
    <br>
    <div class="side-nav-buttons">
      <ul class="nav nav-pills nav-stacked">
        <li ><a href="/" class=" hover-effect"><i class="fa-fw fa fa-home" aria-hidden="true"></i>Home</a></li><li ><a href="/tabs/projects.html" class=" hover-effect"><i class="fa-fw fa fa-cog" aria-hidden="true"></i>Projects</a></li><li ><a href="/tabs/platform-demo.html" class=" hover-effect"><i class="fa-fw " aria-hidden="true"></i>My Kubernetes Platform</a></li><li ><a href="/tabs/skills.html" class=" hover-effect"><i class="fa-fw fa fa-code" aria-hidden="true"></i>Skills</a></li><li ><a href="/tabs/publications.html" class=" hover-effect"><i class="fa-fw fa fa-file-text-o" aria-hidden="true"></i>Publications</a></li><li ><a href="/tabs/certifications.html" class=" hover-effect"><i class="fa-fw fa fa-certificate" aria-hidden="true"></i>Certifications</a></li><li ><a href="/tabs/resume/" class=" hover-effect"><i class="fa-fw fa fa-file-text" aria-hidden="true"></i>Resume</a></li><li ><a href="/tabs/about.html" class=" hover-effect"><i class="fa-fw fa fa-user-o" aria-hidden="true"></i>About</a></li></ul>
    </div>
    <br>
    <br><div class="contact-container">
  <hr>
  <h3>Contact</h3>
  <ul><li><a href="https://github.com/jtayl222" aria-label="github" class="hover-effect-big" target="_blank" rel="noopener noreferrer"><i class="fa fa-github" aria-hidden="true"></i></a></li><li><a href="https://www.linkedin.com/in/jefftaylor22" aria-label="linkedin" class="hover-effect-big" target="_blank" rel="noopener noreferrer"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li></ul>
</div>

    <hr id="toc-view-top">
    <div class="side-nav-footer" translate="no">
        <p>&copy;  Jeffrey Taylor.</p>
      </div>
  </div>
  <div class="side-nav-bottom-buttons-container">
    <hr>
    <ul>
      <li><div class="color_scheme_switch_side_holder" data-toggle="tooltip" data-placement="top" title="Color scheme">
  <label class="color-scheme-switch hover-effect">
    <input type="checkbox" class="checkbox_color_switch" />
    <span></span>
  </label>
</div>
</li><li><div class="cookie-icon hover-effect" onclick="CookieConsent.showSettings();" data-toggle="tooltip" data-placement="top" title="Cookie settings">
  <div class="cookie-wrapper">
    <i class="fa fa-circle bitten-cookie" aria-hidden="true"></i>
    <i class="fa fa-circle small-ellipse-icon" aria-hidden="true"></i>
    <i class="fa fa-spinner inner-icon" aria-hidden="true"></i>
    <i class="fa fa-circle-thin outer-icon" aria-hidden="true"></i>
  </div>
</div>
</li></ul>
  </div></nav>
<div id="main-wrapper">
      <div class="main-container"><h1 id="part-2-building-production-ab-testing-infrastructure-for-fraud-detection-models">Part 2: Building Production A/B Testing Infrastructure for Fraud Detection Models</h1>

<p><em>Technical Implementation with Seldon Core v2 Pattern 3</em></p>

<p><strong>Keywords</strong>: Seldon Core v2, Fraud Detection MLOps, Kubernetes ML deployment, Pattern 3 architecture, production ML infrastructure, fraud model serving, Prometheus MLOps monitoring, seldon-mesh LoadBalancer, ML pipeline automation, enterprise fraud detection</p>

<p><strong>Meta Description</strong>: Build production-ready A/B testing infrastructure for fraud detection models with Seldon Core v2 Pattern 3, comprehensive preprocessing validation, and automated decision making. Real-world implementation guide.</p>

<hr />

<h2 id="about-this-series">About This Series</h2>

<p>This is Part 2 of a comprehensive 2-part series documenting the construction and operation of a production-grade fraud detection MLOps platform. This series provides a complete guide to building, deploying, and managing fraud detection systems in a real-world enterprise environment using official Seldon Core v2 architecture patterns.</p>

<p><strong>The Complete Series:</strong></p>
<ul>
  <li><strong>Part 1</strong>: <a href="./fraud-ab-testing-part-1.html">A/B Testing in Production MLOps - Why Traditional Deployments Fail ML Models</a></li>
  <li><strong>Part 2</strong>: Building Production A/B Testing Infrastructure - Seldon Core v2 Pattern 3, Feature Preprocessing, and Real-World Implementation (This Article)</li>
</ul>

<hr />

<h2 id="technical-architecture-production-ready-fraud-detection-ab-testing">Technical Architecture: Production-Ready Fraud Detection A/B Testing</h2>

<p>Building on our credit card fraud detection example from Part 1, let’s implement a complete A/B testing system using <strong>Seldon Core v2 Pattern 3</strong> - the official, recommended architecture for production deployments.</p>

<h3 id="system-overview-seldon-core-v2-pattern-3-architecture">System Overview: Seldon Core v2 Pattern 3 Architecture</h3>

<p>Our fraud detection A/B testing infrastructure follows the official Seldon Core v2 Pattern 3 design:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Production Fraud Detection A/B Testing Pipeline (Pattern 3):

[External Client] → [seldon-mesh LoadBalancer] → [Seldon Scheduler] → [A/B Router] → [Model V1/V2]
       ↓                        ↓                        ↓                ↓              ↓
   Transaction         192.168.1.212          Experiment        80/20 Split    TensorFlow Models
       ↓                        ↓                        ↓                ↓              ↓
   Raw Features      Host: fraud-detection.local    Traffic Routing   Preprocessing   Scaled Features
       ↓                        ↓                        ↓                ↓              ↓
   V1-V28,Amount,Time    V2 Inference Protocol     fraud-v1-baseline   StandardScaler  Optimal Thresholds
                                 ↓                        ↓                ↓              ↓
                            [Prometheus Metrics] ← [Response] ← [0.5/0.9 Threshold] ← [Fraud/Normal]
</code></pre></div></div>

<p><strong>Key Pattern 3 Components:</strong></p>
<ul>
  <li><strong>Centralized ServerConfig:</strong> Located in <code class="language-plaintext highlighter-rouge">seldon-system</code> namespace, shared across all models</li>
  <li><strong>seldon-mesh LoadBalancer:</strong> External access point (192.168.1.212) with Host-based routing</li>
  <li><strong>Namespace Separation:</strong> ServerConfig in <code class="language-plaintext highlighter-rouge">seldon-system</code>, runtime components in <code class="language-plaintext highlighter-rouge">fraud-detection</code></li>
  <li><strong>Official Architecture:</strong> No custom operator patches or workarounds needed</li>
</ul>

<h2 id="foundation-seldon-core-v2-pattern-3-deployment">Foundation: Seldon Core v2 Pattern 3 Deployment</h2>

<h3 id="production-cluster-configuration">Production Cluster Configuration</h3>

<p>Our production fraud detection cluster runs the official Seldon Core v2 Pattern 3:</p>

<table>
  <thead>
    <tr>
      <th>Component</th>
      <th>Namespace</th>
      <th>Status</th>
      <th>Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ServerConfig</td>
      <td>seldon-system</td>
      <td>✅ Centralized</td>
      <td>Shared MLServer configuration</td>
    </tr>
    <tr>
      <td>Seldon Scheduler</td>
      <td>seldon-system</td>
      <td>✅ Operational</td>
      <td>Traffic routing and A/B experiments</td>
    </tr>
    <tr>
      <td>seldon-mesh LoadBalancer</td>
      <td>seldon-system</td>
      <td>✅ External IP</td>
      <td>External access (192.168.1.212)</td>
    </tr>
    <tr>
      <td>Model Runtime</td>
      <td>fraud-detection</td>
      <td>✅ Deployed</td>
      <td>MLServer instances for V1/V2 models</td>
    </tr>
    <tr>
      <td>Experiment Controller</td>
      <td>fraud-detection</td>
      <td>✅ Active</td>
      <td>80/20 A/B traffic splitting</td>
    </tr>
  </tbody>
</table>

<h3 id="centralized-serverconfig-pattern-3-core">Centralized ServerConfig (Pattern 3 Core)</h3>

<p>The heart of Pattern 3 is the centralized ServerConfig in the <code class="language-plaintext highlighter-rouge">seldon-system</code> namespace:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># k8s/base/server-config-centralized.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">mlops.seldom.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ServerConfig</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">mlserver</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">seldon-system</span>  <span class="c1"># Pattern 3: Centralized in seldon-system</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">mlserver</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">resources</span><span class="pi">:</span>
    <span class="na">requests</span><span class="pi">:</span>
      <span class="na">cpu</span><span class="pi">:</span> <span class="s">500m</span>
      <span class="na">memory</span><span class="pi">:</span> <span class="s">1Gi</span>
    <span class="na">limits</span><span class="pi">:</span>
      <span class="na">cpu</span><span class="pi">:</span> <span class="s">1000m</span>
      <span class="na">memory</span><span class="pi">:</span> <span class="s">2Gi</span>
  <span class="na">serverType</span><span class="pi">:</span> <span class="s">mlserver</span>
  <span class="na">serverConfig</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">seldonio/mlserver:1.3.5</span>
    <span class="na">env</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MLSERVER_MODELS_DIR</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s">/mnt/models</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MLSERVER_HTTP_PORT</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">8080"</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MLSERVER_GRPC_PORT</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">8081"</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MLSERVER_LOAD_MODELS_AT_STARTUP</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MLSERVER_MODEL_IMPLEMENTATION</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s">mlserver_mlflow.MLflowRuntime</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MLSERVER_MLFLOW_TRACKING_URI</span>
        <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http://mlflow:5000"</span>
</code></pre></div></div>

<h3 id="seldon-core-v2-experiment-configuration">Seldon Core v2 Experiment Configuration</h3>

<p>The A/B testing experiment uses Seldon resource names (not MLServer internal names):</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># k8s/base/fraud-model-ab-test.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">mlops.seldon.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Experiment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">fraud-detection-ab-test</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">fraud-detection</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">default</span><span class="pi">:</span> <span class="s">fraud-v1-baseline</span>      <span class="c1"># Seldon resource name</span>
  <span class="na">candidates</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">fraud-v1-baseline</span>     <span class="c1"># 80% traffic</span>
      <span class="na">weight</span><span class="pi">:</span> <span class="m">80</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">fraud-v2-candidate</span>    <span class="c1"># 20% traffic</span>
      <span class="na">weight</span><span class="pi">:</span> <span class="m">20</span>
  <span class="na">mirror</span><span class="pi">:</span>
    <span class="na">percentage</span><span class="pi">:</span> <span class="m">100</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">fraud-traffic-mirror</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">mlops.seldon.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Model</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">fraud-v1-baseline</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">fraud-detection</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">storageUri</span><span class="pi">:</span> <span class="s">models:/fraud_v1/Production</span>   <span class="c1"># MLflow Model Registry URI</span>
  <span class="na">requirements</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">mlserver</span>
  <span class="pi">-</span> <span class="s">mlserver-mlflow</span>
  <span class="na">serverConfig</span><span class="pi">:</span> <span class="s">mlserver</span>                    <span class="c1"># References centralized ServerConfig</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">mlops.seldon.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Model</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">fraud-v2-candidate</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">fraud-detection</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">storageUri</span><span class="pi">:</span> <span class="s">models:/fraud_v2/Production</span>   <span class="c1"># MLflow Model Registry URI</span>
  <span class="na">requirements</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">mlserver</span>
  <span class="pi">-</span> <span class="s">mlserver-mlflow</span>
  <span class="na">serverConfig</span><span class="pi">:</span> <span class="s">mlserver</span>                    <span class="c1"># References centralized ServerConfig</span>
</code></pre></div></div>

<p><strong>Key Pattern 3 features for fraud detection:</strong></p>
<ul>
  <li><strong>80/20 traffic split</strong>: Conservative approach for financial risk models</li>
  <li><strong>Centralized ServerConfig</strong>: Shared configuration reduces complexity</li>
  <li><strong>seldon-mesh routing</strong>: Single external endpoint with Host-based routing</li>
  <li><strong>MLflow integration</strong>: Direct Model Registry URIs for artifact management</li>
</ul>

<h2 id="critical-discovery-production-preprocessing-pipeline-validation">Critical Discovery: Production Preprocessing Pipeline Validation</h2>

<h3 id="the-production-reality-check">The Production Reality Check</h3>

<p>Our most significant learning came from discovering that <strong>models can load successfully and respond to requests but produce completely incorrect predictions due to preprocessing issues</strong>. Here’s what went wrong and how we systematically resolved it:</p>

<h4 id="problem-models-predicting-00-for-all-transactions">Problem: Models Predicting 0.0 for All Transactions</h4>

<p>Both fraud detection models were deployed successfully via Pattern 3 architecture and returned HTTP 200 responses, but they predicted 0.0 (no fraud) for every transaction - including known fraud examples that should have triggered high-confidence fraud alerts.</p>

<h4 id="root-causes-discovered-through-systematic-debugging">Root Causes Discovered Through Systematic Debugging:</h4>

<ol>
  <li><strong>Feature Ordering Mismatch</strong>
```python
    <h1 id="training-data-order-from-standardscalerfit">Training data order (from StandardScaler.fit())</h1>
    <p>training_feature_order = [‘V1’, ‘V2’, ‘V3’, …, ‘V28’, ‘Amount’, ‘Time’]  # 30 features</p>
  </li>
</ol>

<h1 id="production-api-was-sending-different-order">Production API was sending different order</h1>
<p>production_api_order = [‘Time’, ‘Amount’, ‘V1’, ‘V2’, …, ‘V28’]  # Wrong!</p>

<h1 id="result-model-received-amount-as-v1-time-as-v2-v1-as-v3-etc">Result: Model received Amount as V1, Time as V2, V1 as V3, etc.</h1>
<h1 id="this-completely-scrambled-the-feature-space-the-model-was-trained-on">This completely scrambled the feature space the model was trained on</h1>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
2. **Missing Feature Scaling in Production**
```python
# Training: Features were scaled with StandardScaler
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)  # Mean=0, Std=1

# Production: Raw features sent directly to model
raw_transaction = {'Amount': 123.45, 'V1': -2.3, 'V2': 1.8, ...}
# Model expected scaled features but received raw values
# Raw Amount=123.45 vs scaled Amount≈0.15 → Model confusion
</code></pre></div></div>

<ol>
  <li><strong>Sub-optimal Default Thresholds</strong>
```python
    <h1 id="default-threshold-used-in-production-05-for-both-models">Default threshold used in production: 0.5 for both models</h1>
    <p>default_threshold = 0.5</p>
  </li>
</ol>

<h1 id="optimal-thresholds-from-offline-threshold-tuning-analysis">Optimal thresholds from offline threshold tuning analysis:</h1>
<p>OPTIMAL_THRESHOLDS = {
    “fraud-v1-baseline”: 0.5,     # Actually optimal for V1
    “fraud-v2-candidate”: 0.9     # V2 needs higher threshold for precision
}</p>
<h1 id="v2-with-05-threshold-909-precision">V2 with 0.5 threshold: 90.9% precision</h1>
<h1 id="v2-with-09-threshold-959-precision-5-improvement">V2 with 0.9 threshold: 95.9% precision (5% improvement!)</h1>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
### Solution: Production Pipeline Validation Tool

We created a comprehensive validation tool that proves the entire production pipeline works correctly:

```python
#!/usr/bin/env python3
"""
Production Pipeline Validation Tool for Fraud Detection.

This script validates that the production fraud detection pipeline works correctly by:
- Testing proper feature preprocessing (scaling, ordering) 
- Validating both V1/V2 models respond accurately via seldon-mesh
- Demonstrating A/B testing with optimal thresholds
- Proving the pipeline is ready for extended production A/B testing

This uses Seldon Core v2 Pattern 3 architecture with centralized ServerConfig.
"""

import json
import requests
import numpy as np
import pandas as pd
from sklearn.preprocessing import StandardScaler
from typing import Dict, List

# Configuration for Pattern 3 architecture
SELDON_ENDPOINT = "http://192.168.1.212"  # seldon-mesh LoadBalancer IP
HOST_HEADER = "fraud-detection.local"

# Model thresholds from offline tuning analysis
OPTIMAL_THRESHOLDS = {
    "fraud-v1-baseline": 0.5,     # Conservative baseline
    "fraud-v2-candidate": 0.9     # Optimized for 95%+ precision, 100% recall
}

class FraudDetectionPipeline:
    """Production fraud detection pipeline with proper preprocessing"""
    
    def __init__(self):
        self.scaler = None
        self.feature_columns = None
        self._initialize_preprocessing()
    
    def _initialize_preprocessing(self):
        """Initialize the feature scaler using the EXACT same training data"""
        print("🔧 Initializing Production Preprocessing Pipeline")
        print("=" * 55)
        
        # Load the same training data used to train the models
        train_v2_df = pd.read_csv("data/splits/train_v2.csv")
        
        # Get feature columns in EXACT training order: V1-V28, Amount, Time
        self.feature_columns = [col for col in train_v2_df.columns 
                              if col.startswith('V') or col in ['Time', 'Amount']]
        
        # Fit scaler on training data (same as used in model training)
        self.scaler = StandardScaler()
        self.scaler.fit(train_v2_df[self.feature_columns])
        
        print(f"✅ Scaler fitted on {len(train_v2_df)} training samples")
        print(f"✅ Feature order: {len(self.feature_columns)} features")
        print(f"   Training order: {self.feature_columns[:5]}... {self.feature_columns[-2:]}")
    
    def preprocess_transaction(self, transaction_data: Dict) -&gt; np.ndarray:
        """
        Preprocess a transaction for model inference.
        
        CRITICAL: This must match training preprocessing exactly:
        1. Same feature ordering as training
        2. Same StandardScaler parameters as training  
        3. Same data types and shapes as training
        """
        if self.scaler is None:
            raise RuntimeError("Preprocessing not initialized")
        
        # Create DataFrame with transaction data in TRAINING ORDER
        df_data = {}
        for feature in self.feature_columns:
            if feature not in transaction_data:
                raise ValueError(f"Missing required feature: {feature}")
            df_data[feature] = [transaction_data[feature]]
        
        df = pd.DataFrame(df_data)
        
        # Scale features using the SAME scaler parameters from training
        scaled_features = self.scaler.transform(df[self.feature_columns])
        return scaled_features[0]  # Return single transaction
    
    def predict_fraud(self, transaction_data: Dict, model_name: str) -&gt; Dict:
        """Make fraud prediction using Pattern 3 architecture"""
        start_time = time.time()
        
        try:
            # Preprocess transaction with proper scaling and ordering
            scaled_features = self.preprocess_transaction(transaction_data)
            
            # Create V2 inference payload for Seldon Core v2
            payload = {
                "parameters": {"content_type": "np"},
                "inputs": [{
                    "name": "fraud_features",
                    "shape": [1, 30],
                    "datatype": "FP32", 
                    "data": scaled_features.tolist()
                }]
            }
            
            # Send inference request to seldon-mesh LoadBalancer
            url = f"{SELDON_ENDPOINT}/v2/models/{model_name}/infer"
            headers = {
                "Content-Type": "application/json",
                "Host": HOST_HEADER  # Required for Pattern 3 Host-based routing
            }
            
            print(f"   Debug: Sending request to {url}")
            print(f"   Debug: Using Seldon resource name: {model_name}")
            print(f"   Debug: Payload shape: {payload['inputs'][0]['shape']}")
            
            response = requests.post(url, json=payload, headers=headers, timeout=10)
            inference_time = time.time() - start_time
            
            print(f"   Debug: HTTP {response.status_code}")
            
            if response.status_code == 200:
                result = response.json()
                
                # Extract probability score from V2 response
                fraud_probability = float(result["outputs"][0]["data"][0])
                
                # Apply optimal threshold (key to performance!)
                threshold = OPTIMAL_THRESHOLDS.get(model_name, 0.5)
                is_fraud = fraud_probability &gt; threshold
                
                # Calculate confidence level for business interpretation
                confidence = "HIGH" if fraud_probability &gt; 0.9 else "MEDIUM" if fraud_probability &gt; 0.5 else "LOW"
                
                return {
                    "status": "success",
                    "model_used": model_name,
                    "fraud_probability": fraud_probability,
                    "is_fraud": is_fraud,
                    "confidence": confidence,
                    "threshold_used": threshold,
                    "inference_time_ms": inference_time * 1000,
                    "transaction_amount": transaction_data.get("Amount", 0),
                    "risk_level": "🚨 HIGH RISK" if is_fraud else "✅ LOW RISK"
                }
            else:
                return {
                    "status": "error",
                    "error": f"HTTP {response.status_code}: {response.text}",
                    "inference_time_ms": inference_time * 1000
                }
                
        except Exception as e:
            return {
                "status": "error", 
                "error": str(e),
                "inference_time_ms": (time.time() - start_time) * 1000
            }
    
    def ab_test_prediction(self, transaction_data: Dict) -&gt; Dict:
        """Perform A/B test prediction using both models (Pattern 3)"""
        
        print(f"\n🧪 A/B Test Prediction (Pattern 3)")
        print(f"   Amount: ${transaction_data.get('Amount', 0):.2f}")
        print(f"   Time: {transaction_data.get('Time', 0)}")
        
        # Test both models using Seldon resource names
        baseline_result = self.predict_fraud(transaction_data, "fraud-v1-baseline")
        candidate_result = self.predict_fraud(transaction_data, "fraud-v2-candidate")
        
        print(f"\n   📊 Results:")
        print(f"   Baseline (v1): {baseline_result.get('fraud_probability', 0):.6f} "
              f"({baseline_result.get('risk_level', 'Unknown')})")
        print(f"   Candidate (v2): {candidate_result.get('fraud_probability', 0):.6f} "
              f"({candidate_result.get('risk_level', 'Unknown')})")
        
        # Simulate 80/20 A/B split (as configured in Experiment)
        import random
        if random.random() &lt; 0.8:
            production_model = "baseline"
            production_result = baseline_result
        else:
            production_model = "candidate" 
            production_result = candidate_result
            
        print(f"   🎯 A/B Selection: {production_model} model selected (80/20 split)")
        
        return {
            "baseline_result": baseline_result,
            "candidate_result": candidate_result,
            "ab_selection": production_model,
            "production_result": production_result,
            "comparison": {
                "fraud_detection_difference": (
                    candidate_result.get('fraud_probability', 0) - 
                    baseline_result.get('fraud_probability', 0)
                ),
                "both_agree": (baseline_result.get('is_fraud', False) == 
                              candidate_result.get('is_fraud', False))
            }
        }
</code></pre></div></div>

<h3 id="production-validation-results-pattern-3">Production Validation Results (Pattern 3)</h3>

<p>After implementing proper preprocessing with Pattern 3 architecture, our validation results show:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>🧪 Production Pipeline Validation Tool
<span class="o">==================================================</span>
Validating fraud detection pipeline with proper preprocessing and thresholds

🔧 Initializing Production Preprocessing Pipeline
<span class="o">=======================================================</span>
✅ Scaler fitted on 1008276 training samples
✅ Feature order: 30 features
   Training order: <span class="o">[</span><span class="s1">'V1'</span>, <span class="s1">'V2'</span>, <span class="s1">'V3'</span>, <span class="s1">'V4'</span>, <span class="s1">'V5'</span><span class="o">]</span>... <span class="o">[</span><span class="s1">'Amount'</span>, <span class="s1">'Time'</span><span class="o">]</span>

📊 Testing with 5 transactions

Transaction 1: FRAUD <span class="o">(</span><span class="nv">$38</span>.50<span class="o">)</span>
   Debug: Sending request to http://192.168.1.212/v2/models/fraud-v1-baseline/infer
   Debug: Using Seldon resource name: fraud-v1-baseline
   Debug: HTTP 200
   
🧪 A/B Test Prediction <span class="o">(</span>Pattern 3<span class="o">)</span>
   📊 Results:
   Baseline <span class="o">(</span>v1<span class="o">)</span>: 0.999876 <span class="o">(</span>🚨 HIGH RISK<span class="o">)</span> ✅ Correct
   Candidate <span class="o">(</span>v2<span class="o">)</span>: 0.999728 <span class="o">(</span>🚨 HIGH RISK<span class="o">)</span> ✅ Correct

Transaction 2: NORMAL <span class="o">(</span><span class="nv">$10</span>.00<span class="o">)</span>
   📊 Results:
   Baseline <span class="o">(</span>v1<span class="o">)</span>: 0.000000 <span class="o">(</span>✅ LOW RISK<span class="o">)</span> ✅ Correct
   Candidate <span class="o">(</span>v2<span class="o">)</span>: 0.000000 <span class="o">(</span>✅ LOW RISK<span class="o">)</span> ✅ Correct

📈 Test Summary
<span class="o">==============================</span>
Baseline <span class="o">(</span>v1<span class="o">)</span> accuracy: 100.0%
Candidate <span class="o">(</span>v2<span class="o">)</span> accuracy: 100.0%

🚀 Pattern 3 architecture fully validated and ready <span class="k">for </span>production!
</code></pre></div></div>

<h2 id="online-validation-confirming-real-world-performance">Online Validation: Confirming Real-World Performance</h2>

<h3 id="live-production-testing-results">Live Production Testing Results</h3>

<p>Our online validation using real production traffic confirmed that our A/B testing infrastructure works perfectly:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Online validation results (July 24, 2025)
# Using actual production transactions via Pattern 3 architecture
</span>
<span class="n">validation_results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">baseline_v1</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">precision</span><span class="sh">"</span><span class="p">:</span> <span class="mf">95.65</span><span class="p">,</span>  <span class="c1"># Slightly lower than offline (97.95) - expected
</span>        <span class="sh">"</span><span class="s">recall</span><span class="sh">"</span><span class="p">:</span> <span class="mf">73.33</span><span class="p">,</span>     <span class="c1"># Matches offline expectation (73.51)
</span>        <span class="sh">"</span><span class="s">f1_score</span><span class="sh">"</span><span class="p">:</span> <span class="mf">83.02</span><span class="p">,</span>   <span class="c1"># Consistent with offline (83.99)
</span>        <span class="sh">"</span><span class="s">transactions_tested</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1500</span>
    <span class="p">},</span>
    <span class="sh">"</span><span class="s">candidate_v2</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">precision</span><span class="sh">"</span><span class="p">:</span> <span class="mf">96.77</span><span class="p">,</span>  <span class="c1"># BETTER than offline (90.92) - threshold optimization worked!
</span>        <span class="sh">"</span><span class="s">recall</span><span class="sh">"</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>     <span class="c1"># Perfect - matches offline
</span>        <span class="sh">"</span><span class="s">f1_score</span><span class="sh">"</span><span class="p">:</span> <span class="mf">98.36</span><span class="p">,</span>   <span class="c1"># Exceeds offline (95.25)
</span>        <span class="sh">"</span><span class="s">transactions_tested</span><span class="sh">"</span><span class="p">:</span> <span class="mi">375</span>  <span class="c1"># 20% of traffic via A/B split
</span>    <span class="p">},</span>
    <span class="sh">"</span><span class="s">improvement_analysis</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">recall_improvement</span><span class="sh">"</span><span class="p">:</span> <span class="mf">36.4</span><span class="p">,</span>     <span class="c1"># +36.4% (matches offline +36.03%)
</span>        <span class="sh">"</span><span class="s">precision_improvement</span><span class="sh">"</span><span class="p">:</span> <span class="mf">1.12</span><span class="p">,</span>  <span class="c1"># +1.12% (better than expected -7.03%)
</span>        <span class="sh">"</span><span class="s">f1_improvement</span><span class="sh">"</span><span class="p">:</span> <span class="mf">15.34</span><span class="p">,</span>        <span class="c1"># +15.34% (exceeds offline +11.26%)
</span>        <span class="sh">"</span><span class="s">business_impact</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">STRONGLY_POSITIVE</span><span class="sh">"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Key Validation Success</strong>: Online results not only confirmed our offline analysis but <strong>exceeded expectations</strong> - candidate V2 delivered the predicted +36% recall improvement while <strong>improving</strong> precision instead of degrading it.</p>

<h2 id="comprehensive-fraud-detection-metrics">Comprehensive Fraud Detection Metrics</h2>

<h3 id="prometheus-integration-for-pattern-3">Prometheus Integration for Pattern 3</h3>

<p>We collect specialized metrics for fraud detection models via the seldon-mesh endpoint:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">prometheus_client</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">Histogram</span><span class="p">,</span> <span class="n">Gauge</span>

<span class="c1"># Fraud-specific metrics for Pattern 3 architecture
</span><span class="n">FRAUD_REQUESTS</span> <span class="o">=</span> <span class="nc">Counter</span><span class="p">(</span><span class="sh">'</span><span class="s">fraud_requests_total</span><span class="sh">'</span><span class="p">,</span>
                        <span class="sh">'</span><span class="s">Total fraud detection requests via seldon-mesh</span><span class="sh">'</span><span class="p">,</span> 
                        <span class="p">[</span><span class="sh">'</span><span class="s">model_name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">prediction</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">architecture_pattern</span><span class="sh">'</span><span class="p">])</span>

<span class="n">FRAUD_RESPONSE_TIME</span> <span class="o">=</span> <span class="nc">Histogram</span><span class="p">(</span><span class="sh">'</span><span class="s">fraud_response_time_seconds</span><span class="sh">'</span><span class="p">,</span>
                               <span class="sh">'</span><span class="s">Fraud detection response time via LoadBalancer</span><span class="sh">'</span><span class="p">,</span>
                               <span class="p">[</span><span class="sh">'</span><span class="s">model_name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">endpoint_type</span><span class="sh">'</span><span class="p">])</span>

<span class="n">FRAUD_ACCURACY</span> <span class="o">=</span> <span class="nc">Gauge</span><span class="p">(</span><span class="sh">'</span><span class="s">fraud_model_accuracy</span><span class="sh">'</span><span class="p">,</span>
                      <span class="sh">'</span><span class="s">Fraud detection accuracy (online validation)</span><span class="sh">'</span><span class="p">,</span>
                      <span class="p">[</span><span class="sh">'</span><span class="s">model_name</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">metric_type</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">validation_type</span><span class="sh">'</span><span class="p">])</span>

<span class="k">class</span> <span class="nc">FraudMetricsCollector</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">record_prediction</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">is_fraud</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">actual_fraud</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="c1"># Record prediction via Pattern 3 architecture
</span>        <span class="n">prediction</span> <span class="o">=</span> <span class="sh">"</span><span class="s">fraud</span><span class="sh">"</span> <span class="k">if</span> <span class="n">is_fraud</span> <span class="k">else</span> <span class="sh">"</span><span class="s">normal</span><span class="sh">"</span>
        <span class="n">FRAUD_REQUESTS</span><span class="p">.</span><span class="nf">labels</span><span class="p">(</span>
            <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span> 
            <span class="n">prediction</span><span class="o">=</span><span class="n">prediction</span><span class="p">,</span>
            <span class="n">architecture_pattern</span><span class="o">=</span><span class="sh">"</span><span class="s">pattern_3</span><span class="sh">"</span>
        <span class="p">).</span><span class="nf">inc</span><span class="p">()</span>
        
        <span class="c1"># Update online accuracy metrics
</span>        <span class="n">correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="n">actual_fraud</span><span class="p">)</span>
        <span class="n">current_accuracy</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_online_accuracy</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">correct</span><span class="p">)</span>
        <span class="n">FRAUD_ACCURACY</span><span class="p">.</span><span class="nf">labels</span><span class="p">(</span>
            <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span> 
            <span class="n">metric_type</span><span class="o">=</span><span class="sh">"</span><span class="s">accuracy</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">validation_type</span><span class="o">=</span><span class="sh">"</span><span class="s">online</span><span class="sh">"</span>
        <span class="p">).</span><span class="nf">set</span><span class="p">(</span><span class="n">current_accuracy</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">record_response_time</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">FRAUD_RESPONSE_TIME</span><span class="p">.</span><span class="nf">labels</span><span class="p">(</span>
            <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
            <span class="n">endpoint_type</span><span class="o">=</span><span class="sh">"</span><span class="s">seldon_mesh_loadbalancer</span><span class="sh">"</span>
        <span class="p">).</span><span class="nf">observe</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="key-production-metrics-pattern-3-validated">Key Production Metrics (Pattern 3 Validated)</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Production metrics collected via seldon-mesh (192.168.1.212)
</span><span class="n">fraud_model_accuracy</span><span class="p">{</span><span class="n">model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud-v1-baseline</span><span class="sh">"</span><span class="p">,</span> <span class="n">metric_type</span><span class="o">=</span><span class="sh">"</span><span class="s">recall</span><span class="sh">"</span><span class="p">,</span> <span class="n">validation_type</span><span class="o">=</span><span class="sh">"</span><span class="s">online</span><span class="sh">"</span><span class="p">}</span> <span class="mf">73.33</span>
<span class="n">fraud_model_accuracy</span><span class="p">{</span><span class="n">model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud-v2-candidate</span><span class="sh">"</span><span class="p">,</span> <span class="n">metric_type</span><span class="o">=</span><span class="sh">"</span><span class="s">recall</span><span class="sh">"</span><span class="p">,</span> <span class="n">validation_type</span><span class="o">=</span><span class="sh">"</span><span class="s">online</span><span class="sh">"</span><span class="p">}</span> <span class="mf">100.0</span>

<span class="n">fraud_model_accuracy</span><span class="p">{</span><span class="n">model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud-v1-baseline</span><span class="sh">"</span><span class="p">,</span> <span class="n">metric_type</span><span class="o">=</span><span class="sh">"</span><span class="s">precision</span><span class="sh">"</span><span class="p">,</span> <span class="n">validation_type</span><span class="o">=</span><span class="sh">"</span><span class="s">online</span><span class="sh">"</span><span class="p">}</span> <span class="mf">95.65</span>  
<span class="n">fraud_model_accuracy</span><span class="p">{</span><span class="n">model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud-v2-candidate</span><span class="sh">"</span><span class="p">,</span> <span class="n">metric_type</span><span class="o">=</span><span class="sh">"</span><span class="s">precision</span><span class="sh">"</span><span class="p">,</span> <span class="n">validation_type</span><span class="o">=</span><span class="sh">"</span><span class="s">online</span><span class="sh">"</span><span class="p">}</span> <span class="mf">96.77</span>

<span class="n">fraud_response_time_seconds_bucket</span><span class="p">{</span><span class="n">model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud-v1-baseline</span><span class="sh">"</span><span class="p">,</span> <span class="n">endpoint_type</span><span class="o">=</span><span class="sh">"</span><span class="s">seldon_mesh_loadbalancer</span><span class="sh">"</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span><span class="p">}</span> <span class="mi">1425</span>
<span class="n">fraud_response_time_seconds_bucket</span><span class="p">{</span><span class="n">model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud-v2-candidate</span><span class="sh">"</span><span class="p">,</span> <span class="n">endpoint_type</span><span class="o">=</span><span class="sh">"</span><span class="s">seldon_mesh_loadbalancer</span><span class="sh">"</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span><span class="p">}</span> <span class="mi">356</span>

<span class="n">fraud_requests_total</span><span class="p">{</span><span class="n">model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud-v1-baseline</span><span class="sh">"</span><span class="p">,</span> <span class="n">prediction</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud</span><span class="sh">"</span><span class="p">,</span> <span class="n">architecture_pattern</span><span class="o">=</span><span class="sh">"</span><span class="s">pattern_3</span><span class="sh">"</span><span class="p">}</span> <span class="mi">134</span>
<span class="n">fraud_requests_total</span><span class="p">{</span><span class="n">model_name</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud-v2-candidate</span><span class="sh">"</span><span class="p">,</span> <span class="n">prediction</span><span class="o">=</span><span class="sh">"</span><span class="s">fraud</span><span class="sh">"</span><span class="p">,</span> <span class="n">architecture_pattern</span><span class="o">=</span><span class="sh">"</span><span class="s">pattern_3</span><span class="sh">"</span><span class="p">}</span> <span class="mi">89</span>
</code></pre></div></div>

<h2 id="production-monitoring-and-alerting">Production Monitoring and Alerting</h2>

<h3 id="critical-fraud-detection-alerts-pattern-3">Critical Fraud Detection Alerts (Pattern 3)</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># monitoring/fraud_detection_alerts.yml</span>
<span class="na">groups</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">fraud_detection_pattern3_alerts</span>
  <span class="na">rules</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">FraudModelDown</span>
    <span class="na">expr</span><span class="pi">:</span> <span class="s">up{job="seldon-mesh"} == </span><span class="m">0</span>
    <span class="na">for</span><span class="pi">:</span> <span class="s">2m</span>
    <span class="na">labels</span><span class="pi">:</span>
      <span class="na">severity</span><span class="pi">:</span> <span class="s">critical</span>
    <span class="na">annotations</span><span class="pi">:</span>
      <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">seldon-mesh</span><span class="nv"> </span><span class="s">LoadBalancer</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">down</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Pattern</span><span class="nv"> </span><span class="s">3</span><span class="nv"> </span><span class="s">architecture</span><span class="nv"> </span><span class="s">failure"</span>
      <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Pattern</span><span class="nv"> </span><span class="s">3</span><span class="nv"> </span><span class="s">external</span><span class="nv"> </span><span class="s">access</span><span class="nv"> </span><span class="s">point</span><span class="nv"> </span><span class="s">unavailable"</span>
      
  <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">HighFalsePositiveRate</span>
    <span class="na">expr</span><span class="pi">:</span> <span class="s">(1 - fraud_model_accuracy{metric_type="precision", validation_type="online"}) &gt; </span><span class="m">0.05</span>
    <span class="na">for</span><span class="pi">:</span> <span class="s">10m</span>
    <span class="na">labels</span><span class="pi">:</span>
      <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
    <span class="na">annotations</span><span class="pi">:</span>
      <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">High</span><span class="nv"> </span><span class="s">false</span><span class="nv"> </span><span class="s">positive</span><span class="nv"> </span><span class="s">rate</span><span class="nv"> </span><span class="s">detected:</span><span class="nv"> </span><span class="s">"</span>
      <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Online</span><span class="nv"> </span><span class="s">precision</span><span class="nv"> </span><span class="s">below</span><span class="nv"> </span><span class="s">95%</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">model</span><span class="nv"> </span><span class="s">"</span>
      
  <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">LowFraudRecall</span>
    <span class="na">expr</span><span class="pi">:</span> <span class="s">fraud_model_accuracy{metric_type="recall", validation_type="online"} &lt; </span><span class="m">70</span>
    <span class="na">for</span><span class="pi">:</span> <span class="s">5m</span>
    <span class="na">labels</span><span class="pi">:</span>
      <span class="na">severity</span><span class="pi">:</span> <span class="s">critical</span>
    <span class="na">annotations</span><span class="pi">:</span>
      <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Fraud</span><span class="nv"> </span><span class="s">detection</span><span class="nv"> </span><span class="s">recall</span><span class="nv"> </span><span class="s">below</span><span class="nv"> </span><span class="s">70%"</span>
      <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Online</span><span class="nv"> </span><span class="s">recall</span><span class="nv"> </span><span class="s">degradation</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">"</span>
      
  <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">ABTrafficImbalance</span>
    <span class="na">expr</span><span class="pi">:</span> <span class="pi">|</span>
      <span class="s">abs(</span>
        <span class="s">(sum(rate(fraud_requests_total{model_name="fraud-v1-baseline", architecture_pattern="pattern_3"}[5m])) / </span>
         <span class="s">sum(rate(fraud_requests_total{architecture_pattern="pattern_3"}[5m]))) - 0.8</span>
      <span class="s">) &gt; 0.15</span>
    <span class="na">for</span><span class="pi">:</span> <span class="s">15m</span>
    <span class="na">labels</span><span class="pi">:</span>
      <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
    <span class="na">annotations</span><span class="pi">:</span>
      <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">A/B</span><span class="nv"> </span><span class="s">traffic</span><span class="nv"> </span><span class="s">split</span><span class="nv"> </span><span class="s">deviates</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">expected</span><span class="nv"> </span><span class="s">80/20"</span>
      <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Pattern</span><span class="nv"> </span><span class="s">3</span><span class="nv"> </span><span class="s">Experiment</span><span class="nv"> </span><span class="s">routing</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">maintaining</span><span class="nv"> </span><span class="s">80/20</span><span class="nv"> </span><span class="s">split"</span>

  <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">SeldonMeshConnectivity</span>
    <span class="na">expr</span><span class="pi">:</span> <span class="s">increase(fraud_requests_total{architecture_pattern="pattern_3"}[5m]) == </span><span class="m">0</span>
    <span class="na">for</span><span class="pi">:</span> <span class="s">10m</span>
    <span class="na">labels</span><span class="pi">:</span>
      <span class="na">severity</span><span class="pi">:</span> <span class="s">critical</span>
    <span class="na">annotations</span><span class="pi">:</span>
      <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">No</span><span class="nv"> </span><span class="s">traffic</span><span class="nv"> </span><span class="s">reaching</span><span class="nv"> </span><span class="s">fraud</span><span class="nv"> </span><span class="s">detection</span><span class="nv"> </span><span class="s">models</span><span class="nv"> </span><span class="s">via</span><span class="nv"> </span><span class="s">seldon-mesh"</span>
      <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Pattern</span><span class="nv"> </span><span class="s">3</span><span class="nv"> </span><span class="s">LoadBalancer</span><span class="nv"> </span><span class="s">connectivity</span><span class="nv"> </span><span class="s">issue"</span>
</code></pre></div></div>

<h2 id="production-best-practices-for-pattern-3-architecture">Production Best Practices for Pattern 3 Architecture</h2>

<h3 id="1-centralized-configuration-management">1. Centralized Configuration Management</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Best Practice: Single ServerConfig in seldon-system namespace</span>
<span class="c1"># All models reference this shared configuration</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">mlops.seldon.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ServerConfig</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">mlserver</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">seldon-system</span>  <span class="c1"># Pattern 3: Always seldon-system</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">mlserver</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">serverType</span><span class="pi">:</span> <span class="s">mlserver</span>
  <span class="c1"># ... configuration shared by all fraud detection models</span>
</code></pre></div></div>

<h3 id="2-automated-decision-framework-with-online-validation">2. Automated Decision Framework with Online Validation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">make_fraud_model_decision</span><span class="p">(</span><span class="n">online_metrics</span><span class="p">,</span> <span class="n">offline_metrics</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Automated decision making for fraud detection models using online validation
    </span><span class="sh">"""</span>
    
    <span class="c1"># Extract online performance (ground truth)
</span>    <span class="n">online_recall_baseline</span> <span class="o">=</span> <span class="n">online_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">fraud_v1_recall</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">online_recall_candidate</span> <span class="o">=</span> <span class="n">online_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">fraud_v2_recall</span><span class="sh">'</span><span class="p">]</span> 
    <span class="n">online_precision_baseline</span> <span class="o">=</span> <span class="n">online_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">fraud_v1_precision</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">online_precision_candidate</span> <span class="o">=</span> <span class="n">online_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">fraud_v2_precision</span><span class="sh">'</span><span class="p">]</span>
    
    <span class="c1"># Calculate online improvements (most reliable)
</span>    <span class="n">online_recall_improvement</span> <span class="o">=</span> <span class="n">online_recall_candidate</span> <span class="o">-</span> <span class="n">online_recall_baseline</span>
    <span class="n">online_precision_change</span> <span class="o">=</span> <span class="n">online_precision_candidate</span> <span class="o">-</span> <span class="n">online_precision_baseline</span>
    
    <span class="c1"># Business impact calculation based on online validation
</span>    <span class="c1"># Each 1% recall improvement prevents ~$100k annually
</span>    <span class="c1"># Each 1% precision improvement saves ~$50k annually in reduced investigations
</span>    <span class="n">annual_fraud_prevented</span> <span class="o">=</span> <span class="n">online_recall_improvement</span> <span class="o">*</span> <span class="mi">100000</span>
    <span class="n">annual_investigation_savings</span> <span class="o">=</span> <span class="n">online_precision_change</span> <span class="o">*</span> <span class="mi">50000</span>
    <span class="n">net_annual_value</span> <span class="o">=</span> <span class="n">annual_fraud_prevented</span> <span class="o">+</span> <span class="n">annual_investigation_savings</span>
    
    <span class="c1"># Decision criteria based on online validation
</span>    <span class="k">if</span> <span class="n">online_recall_improvement</span> <span class="o">&gt;=</span> <span class="mi">30</span> <span class="ow">and</span> <span class="n">online_precision_change</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="s">STRONG_RECOMMEND - Online validation shows exceptional performance: +</span><span class="si">{</span><span class="n">online_recall_improvement</span><span class="si">:</span><span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="s">% recall, +</span><span class="si">{</span><span class="n">online_precision_change</span><span class="si">:</span><span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="s">% precision. Net value: $</span><span class="si">{</span><span class="n">net_annual_value</span><span class="si">:</span><span class="p">,.</span><span class="mi">0</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span>
    <span class="k">elif</span> <span class="n">online_recall_improvement</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">online_precision_change</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="s">RECOMMEND - Online validation confirms improvement: +</span><span class="si">{</span><span class="n">online_recall_improvement</span><span class="si">:</span><span class="p">.</span><span class="mi">1</span><span class="n">f</span><span class="si">}</span><span class="s">% recall. Net value: $</span><span class="si">{</span><span class="n">net_annual_value</span><span class="si">:</span><span class="p">,.</span><span class="mi">0</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span>
    <span class="k">elif</span> <span class="n">online_recall_improvement</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="sh">"</span><span class="s">REJECT - Insufficient online recall improvement</span><span class="sh">"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="sh">"</span><span class="s">CONTINUE_TESTING - Online validation inconclusive</span><span class="sh">"</span>
</code></pre></div></div>

<h3 id="3-business-impact-monitoring-with-online-validation">3. Business Impact Monitoring with Online Validation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FraudBusinessImpactAnalyzer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">fraud_loss_per_transaction</span> <span class="o">=</span> <span class="mf">150.0</span>  <span class="c1"># Average fraud loss
</span>        <span class="n">self</span><span class="p">.</span><span class="n">investigation_cost</span> <span class="o">=</span> <span class="mf">25.0</span>           <span class="c1"># Cost per false positive
</span>        <span class="n">self</span><span class="p">.</span><span class="n">daily_transaction_volume</span> <span class="o">=</span> <span class="mi">10000</span>    <span class="c1"># Daily transactions
</span>        
    <span class="k">def</span> <span class="nf">calculate_online_business_impact</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">online_metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Calculate business impact using validated online performance</span><span class="sh">"""</span>
        
        <span class="n">baseline_daily_volume</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">daily_transaction_volume</span> <span class="o">*</span> <span class="mf">0.8</span>  <span class="c1"># 80% traffic
</span>        <span class="n">candidate_daily_volume</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">daily_transaction_volume</span> <span class="o">*</span> <span class="mf">0.2</span>  <span class="c1"># 20% traffic
</span>        <span class="n">fraud_rate</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># 1% of transactions are fraudulent
</span>        
        <span class="c1"># Baseline performance (online validated)
</span>        <span class="n">baseline_recall</span> <span class="o">=</span> <span class="n">online_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">baseline_recall</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>  <span class="c1"># 73.33%
</span>        <span class="n">baseline_precision</span> <span class="o">=</span> <span class="n">online_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">baseline_precision</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>  <span class="c1"># 95.65%
</span>        <span class="n">baseline_false_positive_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">baseline_precision</span>
        
        <span class="n">baseline_fraud_caught</span> <span class="o">=</span> <span class="n">baseline_daily_volume</span> <span class="o">*</span> <span class="n">fraud_rate</span> <span class="o">*</span> <span class="n">baseline_recall</span>
        <span class="n">baseline_false_positives</span> <span class="o">=</span> <span class="n">baseline_daily_volume</span> <span class="o">*</span> <span class="n">baseline_false_positive_rate</span>
        
        <span class="c1"># Candidate performance (online validated) 
</span>        <span class="n">candidate_recall</span> <span class="o">=</span> <span class="n">online_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">candidate_recall</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>  <span class="c1"># 100%
</span>        <span class="n">candidate_precision</span> <span class="o">=</span> <span class="n">online_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">candidate_precision</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>  <span class="c1"># 96.77%
</span>        <span class="n">candidate_false_positive_rate</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">candidate_precision</span>
        
        <span class="n">candidate_fraud_caught</span> <span class="o">=</span> <span class="n">candidate_daily_volume</span> <span class="o">*</span> <span class="n">fraud_rate</span> <span class="o">*</span> <span class="n">candidate_recall</span>
        <span class="n">candidate_false_positives</span> <span class="o">=</span> <span class="n">candidate_daily_volume</span> <span class="o">*</span> <span class="n">candidate_false_positive_rate</span>
        
        <span class="c1"># Business impact calculation
</span>        <span class="k">if</span> <span class="n">baseline_daily_volume</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Normalize to same volume for comparison
</span>            <span class="n">normalized_baseline_fraud_caught</span> <span class="o">=</span> <span class="n">baseline_fraud_caught</span> <span class="o">*</span> <span class="p">(</span><span class="n">candidate_daily_volume</span> <span class="o">/</span> <span class="n">baseline_daily_volume</span><span class="p">)</span>
            <span class="n">normalized_baseline_false_positives</span> <span class="o">=</span> <span class="n">baseline_false_positives</span> <span class="o">*</span> <span class="p">(</span><span class="n">candidate_daily_volume</span> <span class="o">/</span> <span class="n">baseline_daily_volume</span><span class="p">)</span>
            
            <span class="n">additional_fraud_prevented</span> <span class="o">=</span> <span class="n">candidate_fraud_caught</span> <span class="o">-</span> <span class="n">normalized_baseline_fraud_caught</span>
            <span class="n">additional_false_positives</span> <span class="o">=</span> <span class="n">candidate_false_positives</span> <span class="o">-</span> <span class="n">normalized_baseline_false_positives</span>
            
            <span class="n">daily_fraud_savings</span> <span class="o">=</span> <span class="n">additional_fraud_prevented</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">fraud_loss_per_transaction</span>
            <span class="n">daily_investigation_cost</span> <span class="o">=</span> <span class="n">additional_false_positives</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">investigation_cost</span>
            
            <span class="n">net_daily_impact</span> <span class="o">=</span> <span class="n">daily_fraud_savings</span> <span class="o">-</span> <span class="n">daily_investigation_cost</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">additional_fraud_prevented_daily</span><span class="sh">"</span><span class="p">:</span> <span class="n">additional_fraud_prevented</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">additional_investigation_cost_daily</span><span class="sh">"</span><span class="p">:</span> <span class="n">additional_false_positives</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">investigation_cost</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">fraud_prevention_value_daily</span><span class="sh">"</span><span class="p">:</span> <span class="n">daily_fraud_savings</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">net_daily_impact</span><span class="sh">"</span><span class="p">:</span> <span class="n">net_daily_impact</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">annual_projected_impact</span><span class="sh">"</span><span class="p">:</span> <span class="n">net_daily_impact</span> <span class="o">*</span> <span class="mi">365</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">online_validation_status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">CONFIRMED</span><span class="sh">"</span> <span class="k">if</span> <span class="n">net_daily_impact</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="sh">"</span><span class="s">NEGATIVE</span><span class="sh">"</span>
            <span class="p">}</span>
</code></pre></div></div>

<h2 id="key-implementation-lessons-from-pattern-3-deployment">Key Implementation Lessons from Pattern 3 Deployment</h2>

<h3 id="1-official-architecture-reduces-operational-risk">1. <strong>Official Architecture Reduces Operational Risk</strong></h3>
<ul>
  <li>Pattern 3 eliminates custom operator patches and workarounds</li>
  <li>Centralized ServerConfig simplifies configuration management</li>
  <li>seldon-mesh LoadBalancer provides reliable external access</li>
</ul>

<h3 id="2-preprocessing-validation-is-mission-critical">2. <strong>Preprocessing Validation is Mission-Critical</strong></h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This single validation step prevented a production disaster
</span><span class="k">def</span> <span class="nf">validate_preprocessing_pipeline</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">Essential validation before production deployment</span><span class="sh">"""</span>
    
    <span class="c1"># 1. Feature ordering validation
</span>    <span class="n">training_order</span> <span class="o">=</span> <span class="nf">load_training_feature_order</span><span class="p">()</span>
    <span class="n">production_order</span> <span class="o">=</span> <span class="nf">get_production_api_feature_order</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">training_order</span> <span class="o">==</span> <span class="n">production_order</span><span class="p">,</span> <span class="sh">"</span><span class="s">Feature ordering mismatch!</span><span class="sh">"</span>
    
    <span class="c1"># 2. Scaling parameter validation
</span>    <span class="n">training_scaler</span> <span class="o">=</span> <span class="nf">load_training_scaler</span><span class="p">()</span>
    <span class="n">production_scaler</span> <span class="o">=</span> <span class="nf">initialize_production_scaler</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">np</span><span class="p">.</span><span class="nf">allclose</span><span class="p">(</span><span class="n">training_scaler</span><span class="p">.</span><span class="n">mean_</span><span class="p">,</span> <span class="n">production_scaler</span><span class="p">.</span><span class="n">mean_</span><span class="p">),</span> <span class="sh">"</span><span class="s">Scaler mean mismatch!</span><span class="sh">"</span>
    
    <span class="c1"># 3. Model naming validation
</span>    <span class="n">seldon_names</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">fraud-v1-baseline</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">fraud-v2-candidate</span><span class="sh">"</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">seldon_names</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="nf">test_model_endpoint</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Model </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s"> not accessible!</span><span class="sh">"</span>
    
    <span class="k">return</span> <span class="sh">"</span><span class="s">PREPROCESSING_VALIDATED</span><span class="sh">"</span>
</code></pre></div></div>

<h3 id="3-online-validation-can-exceed-offline-expectations">3. <strong>Online Validation Can Exceed Offline Expectations</strong></h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Our Pattern 3 implementation delivered better results than predicted
</span><span class="n">offline_vs_online_comparison</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">candidate_v2_precision</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">offline_expected</span><span class="sh">"</span><span class="p">:</span> <span class="mf">90.92</span><span class="p">,</span>  <span class="c1"># From holdout test
</span>        <span class="sh">"</span><span class="s">online_actual</span><span class="sh">"</span><span class="p">:</span> <span class="mf">96.77</span><span class="p">,</span>     <span class="c1"># From production A/B test
</span>        <span class="sh">"</span><span class="s">improvement</span><span class="sh">"</span><span class="p">:</span> <span class="mf">5.85</span>         <span class="c1"># Better than expected!
</span>    <span class="p">},</span>
    <span class="sh">"</span><span class="s">recall_consistency</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">offline</span><span class="sh">"</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>          <span class="c1"># Perfect in testing
</span>        <span class="sh">"</span><span class="s">online</span><span class="sh">"</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>           <span class="c1"># Perfect in production
</span>        <span class="sh">"</span><span class="s">validation</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">CONFIRMED</span><span class="sh">"</span>   <span class="c1"># Offline results reliable
</span>    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="4-conservative-traffic-splits-enable-safe-validation">4. <strong>Conservative Traffic Splits Enable Safe Validation</strong></h3>
<ul>
  <li>80/20 allocation provided statistical power with limited risk exposure</li>
  <li>Pattern 3 Experiment controller handled traffic routing reliably</li>
  <li>Online validation confirmed expected improvements within 48 hours</li>
</ul>

<h2 id="production-deployment-success">Production Deployment Success</h2>

<p>This comprehensive implementation demonstrates a complete, production-ready fraud detection A/B testing pipeline using Seldon Core v2 Pattern 3 architecture. The system successfully:</p>

<ul>
  <li><strong>Validated Production Performance</strong>: Online testing confirmed +36.4% recall improvement with better precision than expected</li>
  <li><strong>Resolved Critical Infrastructure Issues</strong>: Systematic debugging of preprocessing pipelines prevented production failures</li>
  <li><strong>Implemented Official Architecture</strong>: Pattern 3 design provides maintainable, scalable fraud detection infrastructure</li>
  <li><strong>Demonstrated Business Value</strong>: Real production metrics show significant fraud prevention improvements</li>
</ul>

<p>The complete technical implementation provides the foundation for measuring business impact in any organization’s specific context.</p>

<hr />

<h2 id="key-takeaways">Key Takeaways</h2>

<ol>
  <li><strong>Seldon Core v2 Pattern 3 provides production-grade reliability</strong> - Official architecture eliminates custom patches and operational complexity</li>
  <li><strong>Production preprocessing validation is mission-critical</strong> - Models can load successfully but fail due to feature pipeline issues</li>
  <li><strong>Online validation can exceed offline expectations</strong> - Real production testing revealed better precision retention than predicted</li>
  <li><strong>Optimal threshold tuning significantly improves performance</strong> - V2 with 0.9 threshold achieved 95.9% precision vs 90.9% with default</li>
  <li><strong>Conservative traffic splits enable safe validation</strong> - 80/20 allocation provides statistical power while limiting business risk</li>
  <li><strong>Centralized ServerConfig simplifies operations</strong> - Pattern 3 design reduces configuration complexity and maintenance overhead</li>
</ol>

<hr />

<p><strong>Complete Implementation Achieved</strong>: This concludes our comprehensive guide to building production-ready fraud detection A/B testing infrastructure. The validated system demonstrates real-world MLOps engineering with measurable business impact.</p>

<hr />

<p><em>This concludes the “A/B Testing in Production MLOps” series. The complete fraud detection implementation demonstrates real-world MLOps challenges and solutions using Seldon Core v2 Pattern 3 architecture.</em></p>

<hr />

<h3 id="-essential-reading">📚 <strong>Essential Reading</strong></h3>
<ul>
  <li><a href="https://docs.seldon.io/projects/seldon-core/en/latest/">Seldon Core v2 Documentation</a> - Complete guide to Pattern 3 architecture</li>
  <li><a href="https://ml-ops.org/content/mlops-principles">MLOps Principles</a> - MLOps best practices and patterns</li>
  <li><a href="https://www.kaggle.com/datasets/mlg-ulb/creditcardfraud">Credit Card Fraud Detection</a> - Dataset used in this implementation</li>
</ul>

<h3 id="️-tools-and-frameworks">🛠️ <strong>Tools and Frameworks</strong></h3>
<ul>
  <li><a href="https://kubernetes.io/docs/home/">Kubernetes</a> - Container orchestration platform</li>
  <li><a href="https://prometheus.io/docs/">Prometheus</a> - Monitoring and metrics collection</li>
  <li><a href="https://www.tensorflow.org/guide">TensorFlow</a> - ML model development framework</li>
  <li><a href="https://scikit-learn.org/stable/">scikit-learn</a> - Feature preprocessing and validation</li>
</ul>

<h3 id="️-architecture-resources">🏗️ <strong>Architecture Resources</strong></h3>
<ul>
  <li><a href="https://docs.seldon.io/projects/seldon-core/en/latest/contents/architecture/overview.html">Seldon Core v2 Patterns</a> - Official architecture patterns</li>
  <li><a href="https://mlflow.org/docs/latest/model-registry.html">MLflow Model Registry</a> - Model versioning and management</li>
  <li><a href="https://kubernetes.io/docs/concepts/services-networking/">Kubernetes Networking</a> - LoadBalancer and ingress patterns</li>
</ul>

<p><em>Follow for more enterprise fraud detection MLOps content and Pattern 3 implementation guides.</em></p>
</div><div class="footer-wrapper">
  <div class="footer-container">
    <footer translate="no">
      <div class="footer-text footer-text-centered long-copyright">
          <p>&copy;  Jeffrey Taylor. </p><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" target="_blank" rel="noopener noreferrer" data-toggle="tooltip" data-placement="top" data-tooltip-no-hide title="Except where otherwise noted, content on this web site is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.">
              <img src="/assets/img/default/cc/cc.svg" alt="cc" width="12" height="12">&nbsp;<img src="/assets/img/default/cc/by.svg" alt="by" width="12" height="12">&nbsp;<img src="/assets/img/default/cc/sa.svg" alt="sa" width="12" height="12">&nbsp;<p>Some rights reserved.</p>
            </a></div>
      <p class="footer-powered"><span>Pwrd by </span><a href="https://github.com/MrGreensWorkshop/MrGreen-JekyllTheme" target="_blank" rel="noopener noreferrer">Mr. Green</a></p>
    </footer>
  </div>
</div>
<div class="scroll-to-top-container">
        <a id="scroll-to-top" href="#main-wrapper" role="button" aria-label="Back to top" class="hover-effect"><i class="fa fa-angle-up"></i></a>
      </div></div>

    <div class="searchbox-container">
  <form id="searchbox-form" autocomplete="off">
    <input type="search" id="search-box" placeholder="Search"
    onkeyup="if(this.value!==''){document.getElementById('search-results').style.display = 'block';}"
    onfocusout="this.value='';"
    onblur="setTimeout(function(){ document.getElementById('search-results').style.display = 'none'; }, 100);">
    <ul id="search-results" ></ul>
  </form>
</div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="/assets/js/main.js"></script>





<script src="/assets/js/simple-jekyll-search-1.9.2.min.js"></script><script>
  function loadSearch(jsonData, searchParam) {
    if (!jsonData) jsonData = '';
    var searchInput = document.getElementById('search-box');

    const simpleJekyllSearch = SimpleJekyllSearch({
      searchInput: searchInput
      ,resultsContainer: document.getElementById('search-results')
      ,json: jsonData
      ,searchResultTemplate: '<li> <a href="{url}"> <div> <div class="title">{title}</div> <div class="date">{date}</div> <div style="clear: both;"></div> </div> </a></li>'
      ,noResultsText: '<li>No results were found.</li>'
      ,limit: 10
      ,fuzzy: false
      ,formSubmit: document.getElementById('searchbox-form')
    });

    if (searchParam) {
      searchInput.value = searchParam;
      searchInput.focus();
      searchInput.disabled=false;
      setTimeout(function(){
        simpleJekyllSearch.search(searchParam);
      }, 400);
    }
  }

  </script>

<script>
    function isEmpty(value) {
      if (value === "" || value === null || typeof value === "undefined") return true;
      return false;
    }

    function getQueryParam (param, mach = true) {
      var queryString = window.location.search.substring(1);
      if (isEmpty(queryString)) return null;
      var queries = queryString.split("&");
      for (var i in queries) {
        var pair = decodeURIComponent(queries[i]).split("=");
        if (mach == true){
          if (pair[0] == param) {
            if (isEmpty(pair[1]) === false) return pair[1];
          }
        }else{
          return pair;
        }
        break;
      }
      return null;
    }

    const searchParam = getQueryParam('search');

    (async () => {
      let resp = await fetch('');
      if (!resp.ok) return;
      let jsonData = await resp.json();
      loadSearch(jsonData, searchParam);
    })();
  </script>



<script>
  CookieConsent.consentSettingHtml = "<div class=\"consent-settings\"> <h5>Cookie settings</h5> <br> <p class=\"info-text\">This website uses cookies to optimize site functionality. It will be activated with your approval. Please click each item below for cookie policy. </p> <table> <tr> <td onclick=\"$('.info[data-consent-info=necessary]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Strictly necessary cookies</p> </td> <td> <span class=\"active_text\">Always active</span></td> </tr> </table> <div class=\"info\" data-consent-info=\"necessary\"> <p>These cookies are essential for the website function and cannot be disable. They are usually set when site function like color scheme etc. is changed. These cookies do not store any personally identifiable information. Enables storage related to security such as authentication functionality, fraud prevention, and other user protection. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=analytics]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Performance cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" checked=\"checked\" data-consent=\"analytics\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"analytics\"> <p>Enables storage (such as cookies) related to analytics e.g. visit duration. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=preferences]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Functionality cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"preferences\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"preferences\"> <p>Enables storage that supports the functionality of the website or app e.g. language settings. Enables storage related to personalization e.g. video recommendations. </p> </div> <table> <tr> <td onclick=\"$('.info[data-consent-info=advertising]').slideToggle();$(this).children('i').toggleClass('fa-plus-square-o').toggleClass('fa-minus-square-o')\"> <i class=\"fa-fw fa fa-plus-square-o\" aria-hidden=\"true\"></i> <p>Targeting and advertising cookies</p> </td> <td> <label class=\"slide-switch\"> <input type=\"checkbox\" class=\"checkbox_switch\" data-consent=\"advertising\"> <span class=\"slider\"></span> </label></td> </tr> </table> <div class=\"info\" data-consent-info=\"advertising\"> <p>Enables storage (such as cookies) related to advertising. </p> </div> <br> <div class=\"button-holder\"> <a href=\"javascript:void(0);\" class=\"btn-base btn-left\" onclick=\"CookieConsent.consentSettingDone('deny');\" role=\"button\" rel=\"nofollow\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentSettingDone('accept');\" role=\"button\" rel=\"nofollow\">Allow all</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentSettingDone('save');\" role=\"button\" rel=\"nofollow\">Allow selection</a> </div> </div>";
  CookieConsent.consentSettingSlideType = 'slideBoxTopToDown';
  CookieConsent.consentBarHtml = "<div class=\"consent-bar\"> <a class=\"close-button\" href=\"javascript:void(0);\" onclick=\"CookieConsent.hideConsentBar();\" aria-label=\"Close\" role=\"button\" rel=\"nofollow\"><i class=\"fa-fw fa fa-times\"></i></a> <p>This website uses cookies to optimize site functionality. It will be activated with your approval. </p> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('deny');\" role=\"button\" rel=\"nofollow\">Deny</a> <a href=\"javascript:void(0);\" class=\"btn-base \" onclick=\"CookieConsent.consentBarDone('settings');\" role=\"button\" rel=\"nofollow\">Customize</a> <a href=\"javascript:void(0);\" class=\"btn-base btn-priority\" onclick=\"CookieConsent.consentBarDone('accept');\" role=\"button\" rel=\"nofollow\">Allow all</a> </div>";
  CookieConsent.consent_items = JSON.parse('{"necessary":{"group":["security_storage"],"value":"granted","wait_for_update":500,"cookie_domain":"","no_check_box":true},"analytics":{"group":["analytics_storage"],"value":"denied"},"preferences":{"group":["functionality_storage","personalization_storage"],"value":"denied"},"advertising":{"group":["ad_storage"],"value":"denied"}}');
  CookieConsent.hideConsentBarWithSaveButton = true;

  const consent_settings = CookieConsent.getConsentSettings();
  const default_configs = JSON.parse('{"anonymize_ip":true,"ads_data_redaction":true,"cookie_flags":"SameSite=None;Secure"}');
</script>
<script>
  LangOfferMsgBox.currentPageLng = "en";
  LangOfferMsgBox.supportedLngList = [["en","En","/","View this page in English.","To home","Language"],["ja","Jp","/ja","このページを日本語で表示する。","日本語ホームへ","言語"],["pt","Pt","/pt","Veja esta página em português.","Página principal","Idioma"],["fr","Fr","/fr","Voir cette page en français.","Aller à l'accueil français","Langue"],["zh","Cn","/zh","显示简体中文页面","简体中文页面","语言"],["ko","Ko","/ko","이 페이지를 한국어로 보세요.","한국어 홈페이지로","언어"],["tr","Tr","/tr","Bu sayfayı Türkçe de görüntüleyin.","Türkçe Ana sayfaya","Dil"],["es","Es","/es","Ver esta página en español.","Ir a inicio","Idioma"]];
  LangOfferMsgBox.existLng = [];
  LangOfferMsgBox.disableExtTranslationOffer = true;
  LangOfferMsgBox.slideType = 'slideBoxTopToDown';
</script>
<script>
  SlidingMsgBox.html = "<div class=\"slideBox\"> <a class=\"close-button\" href=\"javascript:void(0);\" aria-label=\"Close\" role=\"button\" rel=\"nofollow\"><i class=\"fa-fw fa fa-times\"></i></a> </div>";
</script>
</body>
</html>

